#!/usr/bin/env python3
"""
ü´Å Condiciones Respiratorias - Base de Conocimiento Expandida
Basado en: ICD-10-CM 2026, GOLD 2024, GINA 2024, ATS/IDSA Guidelines

Cobertura:
- Neumon√≠a Adquirida en Comunidad (J18) ‚úì existente
- EPOC (J44) ‚úì nuevo
- Asma Bronquial (J45) ‚úì nuevo
- Infecci√≥n Respiratoria Aguda Superior (J06) ‚úì nuevo
- Insuficiencia Respiratoria (J96) ‚úì nuevo
- Bronquitis Aguda (J20) ‚úì nuevo
- COVID-19 Respiratorio (U07.1) ‚úì nuevo
- Derrame Pleural (J90) ‚úì nuevo
- Neumot√≥rax (J93) ‚úì nuevo
"""

from dataclasses import dataclass
from typing import List

try:
    from medical_knowledge_base import MedicalCondition
except ImportError:

    @dataclass
    class MedicalCondition:
        """Condici√≥n m√©dica completa"""

        icd10_code: str
        name: str
        category: str
        description: str
        symptoms: List[str]
        risk_factors: List[str]
        complications: List[str]
        diagnostic_criteria: List[str]
        differential_diagnosis: List[str]
        treatment_protocol: List[str]
        emergency_signs: List[str]
        prognosis: str
        follow_up: List[str]


RESPIRATORY_CONDITIONS = {
    # =========================================================================
    # EPOC - ENFERMEDAD PULMONAR OBSTRUCTIVA CR√ìNICA (J44)
    # Fuente: GOLD 2024 (Global Initiative for Chronic Obstructive Lung Disease)
    # =========================================================================
    "J44": MedicalCondition(
        icd10_code="J44",
        name="Enfermedad Pulmonar Obstructiva Cr√≥nica (EPOC)",
        category="Respiratorio",
        description="Enfermedad pulmonar prevenible y tratable caracterizada por s√≠ntomas respiratorios persistentes y limitaci√≥n del flujo a√©reo debido a anormalidades de v√≠as a√©reas y/o alveolares",
        symptoms=[
            "Disnea progresiva (s√≠ntoma cardinal)",
            "Tos cr√≥nica (puede ser intermitente o diaria)",
            "Expectoraci√≥n cr√≥nica",
            "Sibilancias",
            "Opresi√≥n tor√°cica",
            "Fatiga",
            "P√©rdida de peso (en estadios avanzados)",
            "Edema de miembros inferiores (cor pulmonale)",
            "Cianosis (en casos severos)",
            "Uso de m√∫sculos accesorios",
        ],
        risk_factors=[
            "Tabaquismo (>90% de casos)",
            "Exposici√≥n a humo de biomasa",
            "Exposici√≥n ocupacional (polvos, qu√≠micos)",
            "Contaminaci√≥n ambiental",
            "D√©ficit de alfa-1 antitripsina",
            "Antecedente de tuberculosis",
            "Asma cr√≥nica no tratada",
            "Bajo peso al nacer/infecciones respiratorias en infancia",
            "Historia de infecciones respiratorias frecuentes",
        ],
        complications=[
            "Exacerbaciones agudas (principal causa de morbimortalidad)",
            "Insuficiencia respiratoria cr√≥nica",
            "Cor pulmonale (insuficiencia card√≠aca derecha)",
            "Hipertensi√≥n pulmonar",
            "Neumot√≥rax",
            "C√°ncer de pulm√≥n (riesgo aumentado)",
            "Depresi√≥n y ansiedad",
            "Osteoporosis",
            "Caquexia",
            "Policitemia secundaria",
        ],
        diagnostic_criteria=[
            "ESPIROMETR√çA POST-BRONCODILATADOR (obligatoria):",
            "  - FEV1/FVC <0.70 confirma obstrucci√≥n persistente",
            "CLASIFICACI√ìN DE SEVERIDAD (GOLD 1-4 por FEV1):",
            "  - GOLD 1 (Leve): FEV1 ‚â•80% predicho",
            "  - GOLD 2 (Moderada): 50% ‚â§ FEV1 < 80%",
            "  - GOLD 3 (Severa): 30% ‚â§ FEV1 < 50%",
            "  - GOLD 4 (Muy severa): FEV1 <30%",
            "EVALUACI√ìN COMBINADA ABE (s√≠ntomas + exacerbaciones):",
            "  - mMRC o CAT para s√≠ntomas",
            "  - Historia de exacerbaciones (‚â•2 moderadas o ‚â•1 hospitalizaci√≥n)",
            "ESTUDIOS COMPLEMENTARIOS:",
            "  - Rx t√≥rax: hiperinsuflaci√≥n, aplanamiento diafragm√°tico",
            "  - Gasometr√≠a arterial si FEV1 <50% o signos de hipoxemia",
            "  - Alfa-1 antitripsina si <45 a√±os o historia familiar",
        ],
        differential_diagnosis=[
            "Asma bronquial",
            "Insuficiencia card√≠aca",
            "Bronquiectasias",
            "Tuberculosis",
            "C√°ncer de pulm√≥n",
            "Fibrosis pulmonar",
            "Tos cr√≥nica por otros medicamentos (IECA)",
        ],
        treatment_protocol=[
            "CESACI√ìN TAB√ÅQUICA (lo m√°s importante):",
            "  - Consejer√≠a + farmacoterapia (vareniclina, bupropi√≥n, TRN)",
            "TRATAMIENTO FARMACOL√ìGICO ESCALONADO:",
            "  Grupo A (pocos s√≠ntomas, bajo riesgo):",
            "    - Broncodilatador seg√∫n necesidad (SABA o SAMA)",
            "  Grupo B (m√°s s√≠ntomas, bajo riesgo):",
            "    - LABA o LAMA de mantenimiento",
            "    - Si persisten s√≠ntomas: LABA + LAMA",
            "  Grupo E (exacerbaciones):",
            "    - LABA + LAMA inicial",
            "    - Si eosin√≥filos ‚â•300: LABA + LAMA + ICS",
            "BRONCODILATADORES:",
            "  - LABA: Formoterol, Salmeterol, Indacaterol, Olodaterol",
            "  - LAMA: Tiotropio, Glicopirronio, Umeclidinio, Aclidinio",
            "  - Combinaciones: Tiotropio-Olodaterol, Umeclidinio-Vilanterol",
            "ICS (si eosin√≥filos elevados y exacerbaciones):",
            "  - Budesonida, Fluticasona (en combinaci√≥n con LABA)",
            "OXIGENOTERAPIA:",
            "  - Si PaO2 ‚â§55 mmHg o SatO2 ‚â§88% en reposo",
            "REHABILITACI√ìN PULMONAR (altamente efectiva)",
            "VACUNACI√ìN: Influenza anual, Neumococo",
        ],
        emergency_signs=[
            "EXACERBACI√ìN SEVERA:",
            "  - Disnea en reposo",
            "  - Frecuencia respiratoria >30/min",
            "  - SatO2 <90%",
            "  - Uso de m√∫sculos accesorios marcado",
            "  - Cianosis de nueva aparici√≥n",
            "  - Alteraci√≥n del estado mental",
            "  - Edemas perif√©ricos de nueva aparici√≥n",
            "  - Inestabilidad hemodin√°mica",
        ],
        prognosis="Variable seg√∫n severidad. FEV1 y frecuencia de exacerbaciones son principales predictores. √çndice BODE (BMI, Obstrucci√≥n, Disnea, Ejercicio) para pron√≥stico.",
        follow_up=[
            "Control cada 3-12 meses seg√∫n severidad",
            "Espirometr√≠a anual",
            "Evaluaci√≥n de t√©cnica inhalatoria en cada visita",
            "Monitoreo de exacerbaciones",
            "Evaluaci√≥n de s√≠ntomas (CAT, mMRC)",
            "Screening de comorbilidades (CV, osteoporosis, depresi√≥n)",
            "Vacunaci√≥n anual influenza",
        ],
    ),
    # =========================================================================
    # ASMA BRONQUIAL (J45)
    # Fuente: GINA 2024 (Global Initiative for Asthma)
    # =========================================================================
    "J45": MedicalCondition(
        icd10_code="J45",
        name="Asma Bronquial",
        category="Respiratorio",
        description="Enfermedad inflamatoria cr√≥nica de las v√≠as a√©reas con hiperreactividad bronquial y obstrucci√≥n reversible del flujo a√©reo",
        symptoms=[
            "Disnea epis√≥dica",
            "Sibilancias (especialmente espiratorias)",
            "Tos seca o productiva",
            "Opresi√≥n tor√°cica",
            "S√≠ntomas empeoran:",
            "  - Por la noche o madrugada",
            "  - Con ejercicio",
            "  - Con exposici√≥n a al√©rgenos o irritantes",
            "  - Con infecciones respiratorias",
            "  - Con cambios de clima",
            "Variabilidad de s√≠ntomas",
            "S√≠ntomas mejoran con broncodilatadores",
        ],
        risk_factors=[
            "Atopia personal o familiar (rinitis, eczema)",
            "Historia familiar de asma",
            "Exposici√≥n a al√©rgenos (√°caros, polen, mascotas, hongos)",
            "Exposici√≥n a humo de tabaco",
            "Contaminaci√≥n ambiental",
            "Infecciones respiratorias virales en infancia",
            "Obesidad",
            "Exposici√≥n ocupacional",
            "Sexo masculino en infancia, femenino en adultos",
        ],
        complications=[
            "Exacerbaciones severas (crisis asm√°tica)",
            "Remodelaci√≥n de v√≠a a√©rea (asma cr√≥nica)",
            "Insuficiencia respiratoria",
            "Neumot√≥rax (raro)",
            "Status asm√°tico",
            "Efectos secundarios de corticoides sist√©micos cr√≥nicos",
            "Muerte por asma (prevenible)",
        ],
        diagnostic_criteria=[
            "HISTORIA CL√çNICA:",
            "  - S√≠ntomas respiratorios variables (sibilancias, disnea, tos, opresi√≥n)",
            "  - M√°s de un s√≠ntoma",
            "  - S√≠ntomas var√≠an en intensidad y tiempo",
            "  - Empeoran por noche/madrugada, con ejercicio, al√©rgenos, infecciones",
            "DEMOSTRACI√ìN DE OBSTRUCCI√ìN VARIABLE:",
            "  - Espirometr√≠a: FEV1/FVC reducido con:",
            "    Reversibilidad: aumento FEV1 ‚â•12% y ‚â•200mL post-broncodilatador",
            "  - Variabilidad del PEF diurno >10% en adultos",
            "  - Test de provocaci√≥n bronquial positivo (metacolina, ejercicio)",
            "CLASIFICACI√ìN DE CONTROL:",
            "  - Bien controlada: s√≠ntomas diurnos ‚â§2/sem, nocturnos 0, rescate ‚â§2/sem, sin limitaci√≥n",
            "  - Parcialmente controlada: 1-2 de los anteriores presentes",
            "  - No controlada: ‚â•3 de los anteriores presentes",
            "CLASIFICACI√ìN DE SEVERIDAD (retrospectiva por tratamiento necesario):",
            "  - Leve, Moderada, Severa",
        ],
        differential_diagnosis=[
            "EPOC",
            "Disfunci√≥n de cuerdas vocales",
            "Insuficiencia card√≠aca",
            "Bronquiectasias",
            "Fibrosis qu√≠stica",
            "ERGE con s√≠ntomas respiratorios",
            "Rinosinusitis con goteo post-nasal",
            "Tos inducida por f√°rmacos (IECA)",
            "Hiperventilaci√≥n/ansiedad",
        ],
        treatment_protocol=[
            "GINA 2024 - ENFOQUE BASADO EN TRACKS:",
            "TRACK 1 (preferido): ICS-Formoterol como mantenimiento y rescate (MART)",
            "TRACK 2 (alternativo): ICS mantenimiento + SABA rescate",
            "",
            "ESCALONES DE TRATAMIENTO (Track 1 preferido):",
            "  Paso 1-2: ICS-Formoterol a demanda (asma leve)",
            "  Paso 3: ICS-Formoterol dosis baja diario",
            "  Paso 4: ICS-Formoterol dosis media",
            "  Paso 5: Agregar LAMA, considerar biol√≥gicos",
            "",
            "MEDICAMENTOS:",
            "  ICS: Budesonida, Beclometasona, Fluticasona, Ciclesonida",
            "  LABA: Formoterol, Salmeterol, Vilanterol",
            "  LAMA: Tiotropio (add-on en asma severa)",
            "  Combinaciones: Budesonida-Formoterol, Fluticasona-Salmeterol",
            "  Biol√≥gicos (asma severa): Omalizumab, Mepolizumab, Benralizumab, Dupilumab",
            "",
            "TRATAMIENTO NO FARMACOL√ìGICO:",
            "  - Evitar desencadenantes",
            "  - Educaci√≥n y plan de acci√≥n escrito",
            "  - T√©cnica de inhalaci√≥n correcta",
            "  - Control de comorbilidades (rinitis, ERGE)",
            "",
            "NUNCA USAR SABA SOLO SIN ICS (aumenta riesgo de exacerbaciones)",
        ],
        emergency_signs=[
            "EXACERBACI√ìN SEVERA/CRISIS ASM√ÅTICA:",
            "  - Disnea en reposo, habla con palabras",
            "  - FR >30/min",
            "  - FC >120/min",
            "  - SatO2 <90%",
            "  - PEF <50% del predicho o mejor personal",
            "  - Uso de m√∫sculos accesorios",
            "  - Agitaci√≥n, confusi√≥n, somnolencia",
            "  - T√≥rax silente (muy grave)",
            "  - Cianosis",
            "  - Incapacidad para hablar frases",
        ],
        prognosis="Excelente con tratamiento adecuado. La mayor√≠a de pacientes pueden lograr buen control. Mortalidad por asma ha disminuido pero sigue siendo prevenible.",
        follow_up=[
            "Control 1-3 meses despu√©s de inicio/cambio de tratamiento",
            "Luego cada 3-12 meses seg√∫n control",
            "Espirometr√≠a al diagn√≥stico, 3-6 meses post-inicio, luego peri√≥dica",
            "Evaluaci√≥n de control en cada visita",
            "Revisi√≥n de t√©cnica inhalatoria y adherencia",
            "Actualizaci√≥n de plan de acci√≥n",
            "Considerar reducir escal√≥n si control por ‚â•3 meses",
        ],
    ),
    # =========================================================================
    # INFECCI√ìN RESPIRATORIA AGUDA SUPERIOR (J06)
    # Fuente: IDSA Guidelines, UpToDate
    # =========================================================================
    "J06": MedicalCondition(
        icd10_code="J06",
        name="Infecci√≥n Respiratoria Aguda de V√≠as Superiores",
        category="Respiratorio",
        description="Infecci√≥n aguda, generalmente viral, que afecta nariz, faringe, laringe y senos paranasales. Incluye resfriado com√∫n, faringitis viral y rinosinusitis aguda viral",
        symptoms=[
            "Rinorrea (inicialmente hialina, puede tornarse mucopurulenta)",
            "Congesti√≥n nasal",
            "Estornudos",
            "Odinofagia (dolor de garganta)",
            "Tos seca o productiva",
            "Febr√≠cula o fiebre leve",
            "Cefalea",
            "Malestar general",
            "Mialgias leves",
            "Disfon√≠a (si laringitis)",
            "Otalgia (referida o por otitis)",
        ],
        risk_factors=[
            "Contacto con personas infectadas",
            "Estaciones fr√≠as (oto√±o-invierno)",
            "Ni√±os en edad escolar",
            "Trabajadores de salud/educaci√≥n",
            "Tabaquismo",
            "Hacinamiento",
            "Inmunosupresi√≥n",
            "Estr√©s cr√≥nico y falta de sue√±o",
        ],
        complications=[
            "Sinusitis bacteriana secundaria",
            "Otitis media aguda",
            "Exacerbaci√≥n de asma/EPOC",
            "Neumon√≠a (raro, m√°s en ancianos/inmunosuprimidos)",
            "Convulsiones febriles (ni√±os)",
        ],
        diagnostic_criteria=[
            "DIAGN√ìSTICO CL√çNICO (no requiere estudios):",
            "  - S√≠ntomas de inicio agudo",
            "  - Duraci√≥n t√≠pica 7-10 d√≠as",
            "  - Ausencia de signos de alarma",
            "CUANDO SOSPECHAR INFECCI√ìN BACTERIANA:",
            "  - S√≠ntomas >10 d√≠as sin mejor√≠a",
            "  - S√≠ntomas severos: fiebre alta ‚â•39¬∞C, rinorrea purulenta o dolor facial ‚â•3 d√≠as",
            "  - Empeoramiento tras mejor√≠a inicial (doble enfermar)",
            "CRITERIOS DE CENTOR MODIFICADO (faringitis estreptoc√≥cica):",
            "  - Fiebre >38¬∞C (+1)",
            "  - Ausencia de tos (+1)",
            "  - Adenopat√≠a cervical anterior (+1)",
            "  - Exudado amigdalino (+1)",
            "  - Edad 3-14 a√±os (+1), 15-44 a√±os (0), ‚â•45 a√±os (-1)",
            "  - Score ‚â•3: considerar test r√°pido/cultivo",
        ],
        differential_diagnosis=[
            "Rinitis al√©rgica",
            "Influenza (inicio m√°s abrupto, mialgias severas)",
            "COVID-19",
            "Faringitis estreptoc√≥cica",
            "Mononucleosis infecciosa",
            "Sinusitis bacteriana",
            "Cuerpo extra√±o nasal (ni√±os)",
        ],
        treatment_protocol=[
            "TRATAMIENTO SINTOM√ÅTICO (antibi√≥ticos NO indicados):",
            "  - Hidrataci√≥n abundante",
            "  - Reposo relativo",
            "  - Analg√©sicos/antipir√©ticos: Paracetamol 500-1000mg c/6-8h",
            "    o Ibuprofeno 400mg c/6-8h",
            "  - Descongestionantes nasales t√≥picos (m√°ximo 3-5 d√≠as):",
            "    Oximetazolina, Xilometazolina",
            "  - Lavados nasales con soluci√≥n salina",
            "  - Miel para tos (>1 a√±o de edad)",
            "  - Dextrometorfano si tos muy molesta",
            "",
            "ANTIBI√ìTICOS SOLO SI:",
            "  - Faringitis con alta sospecha de S. pyogenes (Centor ‚â•4):",
            "    Amoxicilina 500mg c/8h x 10 d√≠as, o Penicilina V",
            "  - Sinusitis bacteriana confirmada o alta sospecha:",
            "    Amoxicilina-Clavul√°nico 875/125mg c/12h x 5-7 d√≠as",
            "",
            "EDUCACI√ìN:",
            "  - Curso natural de 7-10 d√≠as",
            "  - Los antibi√≥ticos NO acortan evoluci√≥n de IRA viral",
            "  - Signos de alarma para reconsultar",
        ],
        emergency_signs=[
            "Dificultad respiratoria",
            "Estridor (posible epiglotitis)",
            "Incapacidad para tragar/babeo",
            "Rigidez de nuca (meningitis)",
            "Fiebre muy alta >40¬∞C persistente",
            "Deterioro r√°pido del estado general",
            "Edema facial o periorbitario (complicaci√≥n sinusal)",
        ],
        prognosis="Excelente. Autolimitada en 7-10 d√≠as. La mayor√≠a de complicaciones son evitables con seguimiento adecuado.",
        follow_up=[
            "No requiere seguimiento rutinario",
            "Reconsultar si:",
            "  - S√≠ntomas >10 d√≠as sin mejor√≠a",
            "  - Empeoramiento despu√©s de mejor√≠a inicial",
            "  - Aparici√≥n de signos de alarma",
            "  - Fiebre persistente >3 d√≠as",
        ],
    ),
    # =========================================================================
    # INSUFICIENCIA RESPIRATORIA (J96)
    # Fuente: ATS/ERS Guidelines, ARDS Network
    # =========================================================================
    "J96": MedicalCondition(
        icd10_code="J96",
        name="Insuficiencia Respiratoria Aguda",
        category="Respiratorio",
        description="Incapacidad del sistema respiratorio para mantener un intercambio gaseoso adecuado, resultando en hipoxemia y/o hipercapnia",
        symptoms=[
            "Disnea severa",
            "Taquipnea (FR >30/min)",
            "Uso de m√∫sculos accesorios",
            "Aleteo nasal",
            "Tiraje intercostal/supraclavicular",
            "Cianosis central y perif√©rica",
            "Taquicardia",
            "Alteraci√≥n del estado mental (agitaci√≥n, confusi√≥n, somnolencia)",
            "Diaforesis",
            "Incapacidad para hablar frases completas",
            "Posici√≥n de tr√≠pode",
        ],
        risk_factors=[
            "EPOC exacerbado",
            "Neumon√≠a severa",
            "Asma severa (status asm√°tico)",
            "SDRA (sepsis, aspiraci√≥n, trauma)",
            "Edema pulmonar cardiog√©nico",
            "Embolia pulmonar masiva",
            "Neumot√≥rax a tensi√≥n",
            "Enfermedades neuromusculares",
            "Sobredosis de sedantes/opioides",
            "Obesidad m√≥rbida (hipoventilaci√≥n)",
            "Traumatismo tor√°cico",
        ],
        complications=[
            "Paro cardiorrespiratorio",
            "Da√±o hip√≥xico cerebral",
            "Falla multiorg√°nica",
            "Neumon√≠a asociada a ventilaci√≥n mec√°nica",
            "Barotrauma (en ventilaci√≥n mec√°nica)",
            "Tromboembolismo venoso (inmovilizaci√≥n)",
            "Delirium en UCI",
            "Debilidad adquirida en UCI",
            "Muerte",
        ],
        diagnostic_criteria=[
            "GASOMETR√çA ARTERIAL (diagn√≥stico definitivo):",
            "TIPO I (Hipox√©mica):",
            "  - PaO2 <60 mmHg (o SatO2 <90%) respirando aire ambiente",
            "  - PaCO2 normal o baja",
            "  - Causas: neumon√≠a, SDRA, edema pulmonar, TEP",
            "TIPO II (Hiperc√°pnica):",
            "  - PaCO2 >50 mmHg con pH <7.35",
            "  - PaO2 puede estar baja",
            "  - Causas: EPOC, sobredosis, neuromusculares",
            "√çNDICES DE SEVERIDAD:",
            "  - PaO2/FiO2 (√≠ndice Kirby):",
            "    >400: Normal",
            "    200-300: SDRA leve",
            "    100-200: SDRA moderado",
            "    <100: SDRA severo",
            "  - Gradiente A-a de O2",
            "EVALUACI√ìN INICIAL:",
            "  - ABC (v√≠a a√©rea, respiraci√≥n, circulaci√≥n)",
            "  - Oximetr√≠a de pulso continua",
            "  - Rx t√≥rax urgente",
            "  - ECG",
        ],
        differential_diagnosis=[
            "Seg√∫n etiolog√≠a subyacente:",
            "- Causas pulmonares (neumon√≠a, EPOC, asma, SDRA)",
            "- Causas cardiovasculares (IC, TEP)",
            "- Causas neurol√≥gicas (ACV, intoxicaciones)",
            "- Causas neuromusculares (Guillain-Barr√©, miastenia)",
            "- Causas de v√≠a a√©rea (obstrucci√≥n, angioedema)",
        ],
        treatment_protocol=[
            "SOPORTE INICIAL (ABCDE):",
            "  - Asegurar v√≠a a√©rea permeable",
            "  - Ox√≠geno suplementario inmediato",
            "  - Monitorizaci√≥n continua",
            "",
            "OXIGENOTERAPIA:",
            "  - C√°nula nasal: 1-6 L/min (FiO2 24-44%)",
            "  - Mascarilla simple: 6-10 L/min (FiO2 40-60%)",
            "  - Mascarilla con reservorio: 10-15 L/min (FiO2 60-95%)",
            "  - C√°nula nasal de alto flujo: hasta 60 L/min, FiO2 ajustable",
            "  - Meta: SatO2 ‚â•90% (88-92% en EPOC retenedores)",
            "",
            "VENTILACI√ìN NO INVASIVA (VNI):",
            "  - Indicada en: EPOC exacerbado, edema pulmonar, inmunosuprimidos",
            "  - CPAP o BiPAP",
            "",
            "VENTILACI√ìN MEC√ÅNICA INVASIVA:",
            "  - Si falla VNI, deterioro, incapacidad de proteger v√≠a a√©rea",
            "  - Estrategia protectora: Vt 6 mL/kg peso ideal, P plateau <30 cmH2O",
            "  - PEEP seg√∫n FiO2 (tablas ARDS Network)",
            "",
            "TRATAMIENTO ESPEC√çFICO SEG√öN CAUSA:",
            "  - Broncodilatadores (EPOC, asma)",
            "  - Antibi√≥ticos (neumon√≠a)",
            "  - Diur√©ticos (edema pulmonar)",
            "  - Anticoagulaci√≥n (TEP)",
            "  - Corticoides (EPOC, asma, algunas causas de SDRA)",
        ],
        emergency_signs=[
            "TODO paciente con insuficiencia respiratoria es urgencia m√©dica",
            "Signos de gravedad extrema:",
            "  - Cianosis central",
            "  - Alteraci√≥n profunda del nivel de conciencia",
            "  - Bradicardia (signo pre-paro)",
            "  - Respiraci√≥n ag√≥nica o gasping",
            "  - Paro respiratorio inminente",
            "  - Hipotensi√≥n",
        ],
        prognosis="Variable seg√∫n etiolog√≠a. SDRA: mortalidad 35-45%. EPOC exacerbado con VNI: buen pron√≥stico. Sin tratamiento: fatal.",
        follow_up=[
            "UCI hasta estabilizaci√≥n",
            "Weaning de ventilaci√≥n mec√°nica seg√∫n protocolos",
            "Rehabilitaci√≥n respiratoria post-alta",
            "Control de causa subyacente",
            "Oxigenoterapia domiciliaria si indicada",
            "Seguimiento en 1-2 semanas post-alta",
        ],
    ),
    # =========================================================================
    # BRONQUITIS AGUDA (J20)
    # Fuente: ACCP Guidelines, Cochrane Reviews
    # =========================================================================
    "J20": MedicalCondition(
        icd10_code="J20",
        name="Bronquitis Aguda",
        category="Respiratorio",
        description="Inflamaci√≥n aguda del √°rbol traqueobronquial, generalmente de etiolog√≠a viral, caracterizada por tos que persiste m√°s de 5 d√≠as",
        symptoms=[
            "Tos (s√≠ntoma predominante)",
            "  - Inicialmente seca, luego productiva",
            "  - Duraci√≥n t√≠pica 10-20 d√≠as (puede durar hasta 3-4 semanas)",
            "Expectoraci√≥n (puede ser clara, mucoide o purulenta)",
            "  - El color purulento NO indica infecci√≥n bacteriana",
            "Dolor tor√°cico o malestar por la tos",
            "Fatiga",
            "Febr√≠cula (fiebre alta es rara)",
            "S√≠ntomas de IRA concomitantes (rinorrea, odinofagia)",
            "Sibilancias transitorias",
            "Disnea leve",
        ],
        risk_factors=[
            "Tabaquismo (activo o pasivo)",
            "Exposici√≥n a irritantes ambientales",
            "Infecci√≥n de v√≠a a√©rea superior previa",
            "Reflujo gastroesof√°gico",
            "Asma o hiperreactividad bronquial",
            "Inmunosupresi√≥n",
            "Estaci√≥n fr√≠a",
        ],
        complications=[
            "Tos prolongada (>3 semanas)",
            "Neumon√≠a (poco frecuente)",
            "Exacerbaci√≥n de asma o EPOC",
            "Sinusitis secundaria",
        ],
        diagnostic_criteria=[
            "DIAGN√ìSTICO CL√çNICO:",
            "  - Tos aguda de >5 d√≠as duraci√≥n",
            "  - Sin evidencia de neumon√≠a (sin fiebre alta, sin disnea severa, sin crepitantes focales)",
            "  - No requiere estudios de rutina",
            "",
            "CUANDO REALIZAR Rx T√ìRAX (descartar neumon√≠a):",
            "  - Fiebre >38¬∞C persistente",
            "  - FC >100/min o FR >24/min",
            "  - Estertores crepitantes focales",
            "  - SatO2 <94%",
            "  - Ancianos o inmunocomprometidos con s√≠ntomas severos",
            "",
            "DIAGN√ìSTICO DIFERENCIAL CON OTRAS CAUSAS DE TOS:",
            "  - Si tos >3 semanas: considerar asma, ERGE, goteo post-nasal",
            "  - Procalcitonina puede ayudar a diferenciar viral vs bacteriano",
        ],
        differential_diagnosis=[
            "Neumon√≠a",
            "Asma (especialmente tos variante asma)",
            "EPOC exacerbado",
            "Tos post-infecciosa",
            "Tos por IECA",
            "Reflujo gastroesof√°gico",
            "Goteo post-nasal",
            "Tuberculosis",
            "Tos ferina",
        ],
        treatment_protocol=[
            "ANTIBI√ìTICOS NO INDICADOS DE RUTINA",
            "  - >90% son virales",
            "  - Antibi√≥ticos NO reducen duraci√≥n ni severidad",
            "  - Contribuyen a resistencia bacteriana",
            "",
            "TRATAMIENTO SINTOM√ÅTICO:",
            "  - Hidrataci√≥n adecuada",
            "  - Analg√©sicos/antipir√©ticos: Paracetamol o Ibuprofeno",
            "  - Miel para la tos (efectiva, >1 a√±o edad)",
            "  - Dextrometorfano o Code√≠na (si tos muy disruptiva)",
            "  - Broncodilatadores inhalados (si sibilancias): Salbutamol",
            "",
            "CONSIDERAR ANTIBI√ìTICOS SOLO EN:",
            "  - Sospecha de infecci√≥n por Bordetella pertussis:",
            "    Azitromicina 500mg d√≠a 1, luego 250mg d√≠as 2-5",
            "  - Pacientes ancianos con comorbilidades severas",
            "  - Inmunocomprometidos",
            "",
            "EDUCACI√ìN:",
            "  - Tos puede durar 2-3 semanas (es normal)",
            "  - Expectoraci√≥n purulenta NO significa infecci√≥n bacteriana",
        ],
        emergency_signs=[
            "Disnea significativa",
            "SatO2 <92%",
            "Fiebre alta persistente (>38.5¬∞C por >3 d√≠as)",
            "Hemoptisis significativa",
            "Dolor tor√°cico pleur√≠tico",
            "Deterioro del estado general",
        ],
        prognosis="Excelente. Autolimitada, resoluci√≥n en 2-3 semanas. La tos puede persistir m√°s tiempo en fumadores.",
        follow_up=[
            "No requiere seguimiento de rutina",
            "Reconsultar si:",
            "  - Tos persiste >4 semanas",
            "  - Aparecen signos de alarma",
            "  - Fiebre alta >3 d√≠as",
            "  - Hemoptisis",
            "Consejer√≠a antitab√°quica si fumador",
        ],
    ),
    # =========================================================================
    # DERRAME PLEURAL (J90)
    # Fuente: BTS Guidelines Pleural Disease 2023
    # =========================================================================
    "J90": MedicalCondition(
        icd10_code="J90",
        name="Derrame Pleural",
        category="Respiratorio",
        description="Acumulaci√≥n anormal de l√≠quido en el espacio pleural, pudiendo ser trasudado (falla card√≠aca, cirrosis) o exudado (infecciones, neoplasias, inflamaci√≥n)",
        symptoms=[
            "Disnea (proporcional al tama√±o del derrame)",
            "Dolor tor√°cico pleur√≠tico (m√°s en exudados)",
            "Tos seca",
            "Disminuci√≥n de murmullo vesicular en base afectada",
            "Matidez a la percusi√≥n",
            "Disminuci√≥n de fr√©mito t√°ctil",
            "Egobroncofon√≠a en l√≠mite superior del derrame",
            "S√≠ntomas de la enfermedad subyacente:",
            "  - Edemas, ortopnea (IC)",
            "  - Fiebre, expectoraci√≥n (neumon√≠a)",
            "  - P√©rdida de peso (malignidad)",
        ],
        risk_factors=[
            "TRASUDADOS (m√°s comunes):",
            "  - Insuficiencia card√≠aca",
            "  - Cirrosis hep√°tica",
            "  - S√≠ndrome nefr√≥tico",
            "  - Hipoalbuminemia",
            "EXUDADOS:",
            "  - Neumon√≠a bacteriana (derrame paraneum√≥nico)",
            "  - Tuberculosis",
            "  - Neoplasias (pulmonar, mama, linfoma)",
            "  - Embolia pulmonar",
            "  - Enfermedades autoinmunes (AR, LES)",
            "  - Pancreatitis aguda",
        ],
        complications=[
            "Empiema (infecci√≥n del espacio pleural)",
            "Derrame loculado",
            "Atrapamiento pulmonar",
            "Insuficiencia respiratoria",
            "Neumot√≥rax post-toracocentesis",
            "Hemot√≥rax",
        ],
        diagnostic_criteria=[
            "IMAGEN:",
            "  - Rx t√≥rax PA y lateral: borramiento seno costofr√©nico",
            "    (visible con >200-300 mL de l√≠quido)",
            "  - Ecograf√≠a tor√°cica: m√°s sensible, gu√≠a toracocentesis",
            "  - TAC: caracteriza derrame, detecta lesiones asociadas",
            "",
            "TORACOCENTESIS DIAGN√ìSTICA:",
            "  - Indicada si: causa desconocida, sospecha de exudado",
            "  - No necesaria si: IC conocida con derrame bilateral peque√±o",
            "",
            "CRITERIOS DE LIGHT (exudado si ‚â•1):",
            "  - Prote√≠nas l√≠quido/suero >0.5",
            "  - LDH l√≠quido/suero >0.6",
            "  - LDH l√≠quido >2/3 del l√≠mite superior normal s√©rico",
            "",
            "AN√ÅLISIS DEL L√çQUIDO PLEURAL:",
            "  - Aspecto, pH, glucosa, LDH, prote√≠nas",
            "  - Citolog√≠a, Gram, cultivo",
            "  - ADA (adenosin deaminasa) si sospecha TB",
            "  - Amilasa si sospecha pancreatitis/rotura esof√°gica",
        ],
        differential_diagnosis=[
            "Consolidaci√≥n pulmonar (neumon√≠a)",
            "Atelectasia",
            "Elevaci√≥n diafragm√°tica",
            "Masa pulmonar perif√©rica",
            "Hemot√≥rax",
            "Quilot√≥rax",
        ],
        treatment_protocol=[
            "TRATAMIENTO DE LA CAUSA SUBYACENTE:",
            "  - IC: diur√©ticos, optimizaci√≥n de tratamiento card√≠aco",
            "  - Cirrosis: restricci√≥n de sodio, diur√©ticos",
            "  - Infecciones: antibi√≥ticos apropiados",
            "",
            "TORACOCENTESIS TERAP√âUTICA:",
            "  - Indicada si: derrame grande sintom√°tico",
            "  - M√°ximo 1-1.5L en una sesi√≥n (evitar edema de reexpansi√≥n)",
            "",
            "DERRAME PARANEUM√ìNICO COMPLICADO/EMPIEMA:",
            "  - pH <7.2, glucosa <60, LDH >1000, pus o bacterias",
            "  - Requiere drenaje con tubo de t√≥rax",
            "  - Fibrinol√≠ticos intrapleurales (alteplasa + DNasa)",
            "  - Cirug√≠a (VATS) si falla drenaje",
            "",
            "DERRAME MALIGNO:",
            "  - Toracocentesis evacuadora repetida",
            "  - Pleurodesis qu√≠mica (talco) si recurrente",
            "  - Cat√©ter pleural tunelizado",
            "",
            "DERRAME TUBERCULOSO:",
            "  - Tratamiento antituberculoso est√°ndar",
            "  - Generalmente no requiere drenaje",
        ],
        emergency_signs=[
            "Derrame masivo con insuficiencia respiratoria",
            "Sospecha de hemot√≥rax",
            "Empiema con sepsis",
            "Neumot√≥rax a tensi√≥n post-procedimiento",
            "Derrame que crece r√°pidamente",
        ],
        prognosis="Depende de la etiolog√≠a. Derrames benignos: buen pron√≥stico. Derrame maligno: pron√≥stico reservado (mediana supervivencia 4-6 meses).",
        follow_up=[
            "Rx t√≥rax de control post-toracocentesis",
            "Seguimiento seg√∫n etiolog√≠a",
            "Control de l√≠quido pleural en derrames recurrentes",
            "Evaluaci√≥n oncol√≥gica si derrame maligno",
            "Control de enfermedad de base",
        ],
    ),
    # =========================================================================
    # NEUMOT√ìRAX (J93)
    # Fuente: BTS Guidelines Spontaneous Pneumothorax, ACCP
    # =========================================================================
    "J93": MedicalCondition(
        icd10_code="J93",
        name="Neumot√≥rax",
        category="Respiratorio",
        description="Presencia de aire en el espacio pleural que causa colapso pulmonar parcial o total. Puede ser espont√°neo (primario o secundario) o traum√°tico",
        symptoms=[
            "Dolor tor√°cico pleur√≠tico s√∫bito (90%)",
            "  - Unilateral, ipsilateral",
            "  - Puede irradiar a hombro o espalda",
            "Disnea de inicio agudo",
            "Tos seca",
            "Ansiedad",
            "A la exploraci√≥n:",
            "  - Disminuci√≥n de murmullo vesicular",
            "  - Timpanismo a la percusi√≥n",
            "  - Disminuci√≥n de fr√©mito t√°ctil",
            "  - Desviaci√≥n traqueal (si a tensi√≥n)",
            "Puede ser asintom√°tico (neumot√≥rax peque√±o)",
        ],
        risk_factors=[
            "NEUMOT√ìRAX ESPONT√ÅNEO PRIMARIO:",
            "  - Varones j√≥venes altos y delgados",
            "  - Tabaquismo (aumenta riesgo 20x)",
            "  - Antecedente personal o familiar",
            "  - Cambios de presi√≥n atmosf√©rica",
            "NEUMOT√ìRAX ESPONT√ÅNEO SECUNDARIO:",
            "  - EPOC (m√°s frecuente)",
            "  - Fibrosis qu√≠stica",
            "  - Asma severa",
            "  - Fibrosis pulmonar",
            "  - Neumon√≠a (P. jirovecii en VIH)",
            "  - Neoplasia pulmonar",
            "  - Conectivopat√≠as (Marfan, Ehlers-Danlos)",
            "TRAUM√ÅTICO/IATROG√âNICO:",
            "  - Trauma tor√°cico penetrante o cerrado",
            "  - Toracocentesis, biopsia pulmonar, cat√©ter central",
            "  - Ventilaci√≥n mec√°nica",
        ],
        complications=[
            "Neumot√≥rax a tensi√≥n (emergencia vital)",
            "Neumot√≥rax recurrente (30-50% sin tratamiento)",
            "Hemoneumot√≥rax",
            "Pioneumot√≥rax (infecci√≥n)",
            "Insuficiencia respiratoria",
            "Paro cardiorrespiratorio (si tensi√≥n)",
        ],
        diagnostic_criteria=[
            "Rx T√ìRAX (diagn√≥stico inicial):",
            "  - L√≠nea de pleura visceral visible",
            "  - Ausencia de marcas pulmonares lateralmente",
            "  - Mejor visible en espiraci√≥n",
            "",
            "TAMA√ëO (seg√∫n BTS):",
            "  - Peque√±o: <2cm entre pulm√≥n y pared tor√°cica a nivel hiliar",
            "  - Grande: ‚â•2cm",
            "",
            "TAC (no rutinario):",
            "  - Dudas diagn√≥sticas",
            "  - Evaluar enfermedad pulmonar subyacente",
            "  - B√∫squeda de bullas",
            "",
            "ECOGRAF√çA POINT-OF-CARE:",
            "  - Ausencia de deslizamiento pulmonar",
            "  - Punto pulmonar (muy espec√≠fico)",
            "  - √ötil en trauma y UCI",
            "",
            "NEUMOT√ìRAX A TENSI√ìN (diagn√≥stico cl√≠nico):",
            "  - NO esperar Rx si sospecha alta",
            "  - Disnea severa, hipotensi√≥n, taquicardia",
            "  - Ingurgitaci√≥n yugular, desviaci√≥n traqueal",
            "  - Descompresi√≥n inmediata",
        ],
        differential_diagnosis=[
            "Neumon√≠a",
            "Derrame pleural",
            "Costocondritis",
            "Embolia pulmonar",
            "S√≠ndrome coronario agudo",
            "Herpes z√≥ster (fase pre-eruptiva)",
            "Rotura esof√°gica",
        ],
        treatment_protocol=[
            "NEUMOT√ìRAX A TENSI√ìN (emergencia):",
            "  - Descompresi√≥n con aguja (2do espacio intercostal, l√≠nea medioclavicular)",
            "  - Seguido de tubo de t√≥rax",
            "",
            "NEUMOT√ìRAX ESPONT√ÅNEO PRIMARIO:",
            "  - Peque√±o + asintom√°tico: observaci√≥n, ox√≠geno",
            "  - Peque√±o + sintom√°tico: aspiraci√≥n simple",
            "  - Grande o falla aspiraci√≥n: tubo de t√≥rax (calibre peque√±o 8-14F)",
            "",
            "NEUMOT√ìRAX ESPONT√ÅNEO SECUNDARIO:",
            "  - Todos >50 a√±os o con EPOC: tubo de t√≥rax",
            "  - Peque√±o <1cm + m√≠nimos s√≠ntomas: observaci√≥n hospitalaria",
            "  - Mayor morbilidad, umbral bajo para intervenci√≥n",
            "",
            "PREVENCI√ìN DE RECURRENCIA:",
            "  - Cesaci√≥n tab√°quica (reduce recurrencia 40%)",
            "  - Pleurodesis qu√≠mica o quir√∫rgica (VATS) si:",
            "    - Segundo episodio ipsilateral",
            "    - Primer episodio contralateral",
            "    - Neumot√≥rax bilateral",
            "    - Fuga a√©rea persistente >5 d√≠as",
            "    - Profesiones de riesgo (buceadores, pilotos)",
            "",
            "RETORNO A ACTIVIDADES:",
            "  - Evitar buceo de por vida (riesgo vital)",
            "  - Vuelos comerciales: esperar 1-2 semanas post-resoluci√≥n",
        ],
        emergency_signs=[
            "NEUMOT√ìRAX A TENSI√ìN:",
            "  - Disnea severa progresiva",
            "  - Hipotensi√≥n",
            "  - Taquicardia severa",
            "  - Desviaci√≥n traqueal contralateral",
            "  - Ingurgitaci√≥n yugular",
            "  - Cianosis",
            "  - Disminuci√≥n del nivel de conciencia",
            "  - Actividad el√©ctrica sin pulso",
        ],
        prognosis="NSP: excelente pero recurrencia 30-50% sin pleurodesis. NSS: depende de enfermedad subyacente. Tensi√≥n: fatal sin tratamiento inmediato.",
        follow_up=[
            "Rx t√≥rax de control a las 24-48h si observaci√≥n",
            "Rx t√≥rax pre-alta y 2-4 semanas post-alta",
            "Cesaci√≥n tab√°quica",
            "Evitar buceo permanentemente",
            "Evitar vuelos por 1-2 semanas post-resoluci√≥n",
            "Referir a cirug√≠a tor√°cica si recurrencia o indicaci√≥n de pleurodesis",
        ],
    ),
}


def get_all_respiratory_conditions():
    """Retorna todas las condiciones respiratorias"""
    return RESPIRATORY_CONDITIONS


def get_condition(icd10_code: str):
    """Obtiene una condici√≥n espec√≠fica por c√≥digo ICD-10"""
    return RESPIRATORY_CONDITIONS.get(icd10_code)
